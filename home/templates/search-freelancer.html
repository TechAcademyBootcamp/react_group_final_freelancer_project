{% extends 'base.html' %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'css/search.css' %}" type="text/css">
<sections>
    <div class="custom-container">
        <div class="base"> 
            <input type="text" class="form-control" id="tokenfield-typeahead"/>
            
            <div class="up_left">
                <div class="filter-sec">
                    <h4>Skills</h4>
                    <div class="skills-con">
                        <tag>Adobe <i class="fas fa-times tag-remove"></i></tag>

                    </div>
                </div>
                <div class="filter-sec">
                    <h4>Price</h4>
                    <div class="flex-column">
                        <p>Min Price:</p>
                        <input id="price_min" type="number" placeholder="Min Price">
                    </div>
                    <div class="flex-column">
                        <p>Max Price:</p>
                        <input type="number" id="price_max" placeholder="Max Price">
                    </div>
                </div>
                <div class="filter-sec">
                    <h4>Project difficulty</h4>
                    <div class="flex-column">
                    
                        <div class="align-center">
                            <input type="radio" name="difficulty" value="1">
                            <p>Entry Level</p>
                        </div>
                        <div class="align-center">
                            <input type="radio" name="difficulty" value="2">
                            <p>Intermediate</p>
                        </div>
                        <div class="align-center">
                            <input type="radio" name="difficulty" value="3">
                            <p>Expert</p>
                        </div>
                    </div>
                </div>
                <div class="filter-sec" style="border-bottom: 0;">
                    <h4>Project Prize Type</h4>
                    <div class="flex-column">       
                        <div class="align-center">
                            <input type="radio" name="price" value="1" >
                            <p>Single Project</p>
                        </div>
                        <div class="align-center">
                            <input type="radio"  value="2">
                            <p>Hourly Work</p>
                        </div>                        
                    </div>
                </div>
                
                
                
            </div>
            
            <div class="card_container_right">
                <div class="header border-bottom ">
                    <h4 class="searc_btn">
                        Search
                    </h4>
                    <h4 class="saved_jobs">
                        Saved Jobs
                    </h4>
                </div>
                <div  class="base_middle border-bottom">
                    <div class="top" style="border: 0px; margin-top:30px;">
                        
                            
                            
                        
                        <select style="margin-right: 20px;" onchange="location = this.value;" name="" id="" >
                            <option   value="{%url 'searchjob'%}">Jobs</option>
                            <option value="" selected>Freelancers</option>
                        </select>
                        <input id="search_input" placeholder="Search">

                        <button id="search_btn" type="submit" class="btnb">Search</button>
                        </div>
                        <div class="middle_2 space-between">
                            
                            <div class="align-center" style="z-index: 1;">
                                <i class="fas fa-poll-h icon_container"></i>
                                <h5 class="count_120">
                                    120,753
                                </h5>
                                <p>
                                    jobs found
                                </p>
                            </div>
                            <!-- <div class="filter_cont">
                                <btnb>Filter</btnb>
                              
                            </div> -->
                            
                        </div>
                        
                    </div>
                <div id="card_cont">
                    <!-- <div class="middle border-bottom">
                        <div class="mid_title">
                        <h4 class="title" style="font-weight:700;">
                               {{project.title}}
                            </h4>
                            <p>
                                <b>Hourly</b>   <span style="font-weight: 600;">-remaining  Expert  Time:More than 6 Months,10-30 hours/week</span>
                            </p>
                            <p style="color:  #707070;font-weight: 500;">
                                We are looking for a content writer who excels in business & travel writing.
                                Will be responsible for writing our Business plan, White paper & for releasing 2 product updates on our blog a week, any press releases that may be 
                            </p>
                            <div class="tags row">
                                <tag style="color:  #707070;font-weight: 500;">
                                    Adobe
                                </tag>
                                <tag>
                                    Web Design
                                </tag>
                            </div>
                        </div>                            
                    </div> -->
                </div>
                
                
                <div class="footer border-bottom align-center">
                    
                    <div class="align-center">
                        <h4 class="per_page" style="font-size: medium;">Jobs Per Page</h4>                        
                        <select  id="">
                            <option value="">10</option>
                            <option value="">9</option>
                            <option value="">8</option>
                            <option value="">7</option>
                            <option value="">6</option>
                            <option value="">5</option>
                        </select>
                    </div>
                    <div class="pagination">
                        <ul>
                            <li><a href="#">&lt;</a></li>
                            <li ><a>1</a></li>
                            <li><a href="#">2</a></li>
                            <li><a href="#">3</a></li>
                            <li><a href="#">4</a></li>
                            <li class="active"><a href="#">5</a></li>
                            <li><a href="#">6</a></li>
                            <li><a href="#">7</a></li>
                            <li class="next"><a href="#">&gt;</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

    </div>
</sections>


<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>


<script>
  
    
    
    url="http://127.0.0.1:8000/api/v1.0/search/freelancer/"
    
    
    function setup(url){
        $.ajax({
            url: url,
            method:'GET',
            success: function(data) 
            {
                console.log(data);

                for(id in data){
                
                    project=data[id]
                    var {title,description,id,skills} = project
                    console.log(project); 
                    var element=$("#card_cont").append(`<div class="middle border-bottom">
                        <div class="mid_title">
                        <h4 class="title" style="font-weight:700;">
                            ${title}
                            </h4>
                            <p>
                                <b>Hourly</b>   <span style="font-weight: 600;">-remaining  Expert  Time:More than 6 Months,10-30 hours/week</span>
                            </p>
                            <p style="color:  #707070;font-weight: 500;">
                                ${description.slice(0,250)}...
                            </p>
                            <div class="tags row">
                                <tag style="color:  #707070;font-weight: 500;">
                                    ${skills}
                                </tag>
                            </div>
                        </div>                            
                    </div>`)
                }

            },
            error: function(err)
            {
                alert(err)
                console.log(err);
                alert("NOOOOOOO")
            }
        });
    }
        
    setup(url)


    $('#search_btn').click(function(){
        var level = $('input[name="difficulty"]:checked').val();
        if ($('input[name="difficulty"]:checked').length > 0) {
            var title=$('#search_input').val()
            alert(title)
            $("#card_cont").empty();
            var price_min=$('#price_min').val()
            var price_max=$('#price_max').val()
            var url = `http://127.0.0.1:8000/api/v1.0/search/freelancer/?search=${title}&level=${level}&price_min=${price_min}&price_max=${price_max}`
            alert(url)
            setup(url)

        }
        else{
            level=''
            var title=$('#search_input').val()
            alert(title)
            $("#card_cont").empty();
            var price_min=$('#price_min').val()
            var price_max=$('#price_max').val()
            var url = `http://127.0.0.1:8000/api/v1.0/search/freelancer/?search=${title}&level=${level}&price_min=${price_min}&price_max=${price_max}`
            alert(url)
            setup(url)
        }
        
    })
    
</script>



<script type="text/javascript">
    $(function () {
        var engine = new Bloodhound({
            local: [{
                value: 'red'
            }, {
                value: 'blue'
            }, {
                value: 'green'
            }, {
                value: 'yellow'
            }, {
                value: 'violet'
            }, {
                value: 'brown'
            }, {
                value: 'purple'
            }, {
                value: 'black'
            }, {
                value: 'white'
            }],
            datumTokenizer: function(d) {
                return Bloodhound.tokenizers.whitespace(d.value);
            },
            queryTokenizer: Bloodhound.tokenizers.whitespace
        });

        engine.initialize();

        $('#tokenfield-typeahead').tokenfield({
            typeahead: [null, {
                source: engine.ttAdapter()
            }]
        });
    });
</script>


{% endblock %}
